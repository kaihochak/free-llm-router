---
import Layout from '../layouts/main.astro';
import { ModelTableWithProvider } from '../components/ModelTableWithProvider';
import { DocsCodeBlock } from '../components/DocsCodeBlock';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../components/ui/card';
import { generateAPISchema } from '../lib/seo';

const modelsResponseExample = `{
  "models": [
    { "id": "google/gemini-2.0-flash-exp:free", "name": "Gemini 2.0 Flash", "contextLength": 1000000 }
  ],
  "lastUpdated": "2024-12-23T10:00:00Z"
}`;

const feedbackExample = `// Request
{ "modelId": "...", "issue": "rate_limited" | "unavailable" | "error", "details": "optional" }

// Response
{ "received": true }`;
---

<Layout
  title="Documentation"
  description="API documentation for Free Models API - access free LLM models from OpenRouter."
  jsonLd={generateAPISchema()}
>
  <div class="container mx-auto max-w-5xl px-4 py-12">
    <!-- Live Models with Dynamic Code Snippet -->
    <section id="models" class="mb-12 scroll-mt-20">
      <h2 class="mb-6 text-2xl font-semibold">Free Models</h2>
      <p class="mb-4 text-muted-foreground">Select filters to find models that match your needs. Copy the generated code snippet to use in your app.</p>
      <ModelTableWithProvider client:load />
    </section>

    <!-- API Reference -->
    <section id="api-reference" class="mb-12 scroll-mt-20">
      <h2 class="mb-6 text-2xl font-semibold">API Reference</h2>
      <div class="space-y-4">
        <Card>
          <CardHeader>
            <CardTitle className="font-mono text-base">GET /api/v1/models/openrouter</CardTitle>
            <CardDescription>Returns the list of currently available free models.</CardDescription>
          </CardHeader>
          <CardContent>
            <DocsCodeBlock code={modelsResponseExample} client:load />
          </CardContent>
        </Card>

        <Card>
          <CardHeader>
            <CardTitle className="font-mono text-base">POST /api/feedback</CardTitle>
            <CardDescription>Report issues with a model (rate limiting, errors, unavailability).</CardDescription>
          </CardHeader>
          <CardContent>
            <DocsCodeBlock code={feedbackExample} client:load />
          </CardContent>
        </Card>
      </div>
    </section>

    <!-- Footer -->
    <footer class="border-t pt-8 text-center text-sm text-muted-foreground">
      <p>Model data synced from <a href="https://openrouter.ai" class="underline hover:text-foreground">OpenRouter</a></p>
    </footer>
  </div>
</Layout>
